<!DOCTYPE html>
<html>
  <head>
    <title>Level makitor</title>
    <meta charset="UTF-8">
    <style>
body {
  font-family: monospace;
}
.level {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
.levelRow {
  height: 40px;
}
.levelBlock {
  height: 40px;
  width: 40px;
  display: inline-block;
  transition: transform .2s;
}
.levelBlock:hover {
  transform: scale(0.8);
  box-shadow: inset 0 0 3px rgba(0,0,0,0.5);
}
.air {
  background: white;
}
.ground {
  background: #212121;
}
.lava {
  background: #FF5722;
}
.win {background:#8BC34A;background-image:url(materialicon_flag.svg);background-position:center;background-repeat:no-repeat;}
.jump {background:#9C27B0;height:35px;border-top:5px solid hsl(291, 64%, 32%);background-image:url(materialicon_keyboard_arrow_up.svg);background-position:center;background-repeat:no-repeat;}
.mud {background:#795548;border-top:5px solid hsl(16,25%,28%);height:35px;}
.nojump {background:#FFC107;background-image:url(materialicon_block.svg);background-position:center;background-repeat:no-repeat;}
.ice {background:#00BCD4;background-image:url(iceshine.svg);background-position:center;background-repeat:no-repeat;}
.water {background:#2196F3;}
.left {background-color:#009688;height:35px;border-top:5px solid hsl(174,100%,19%);background-image:url(materialicon_chevron_left.svg);background-position:center;background-repeat:no-repeat;}
.right {background-color:#004D40;height:35px;border-top:5px solid hsl(170,100%,5%);background-image:url(materialicon_chevron_right.svg);background-position:center;background-repeat:no-repeat;}
.check {background-color:#4CAF50;border-top:5px solid hsl(122, 39%, 39%);height:35px;background-image:url(materialicon_beenhere.svg);background-position:center;background-repeat:no-repeat;}
.glitch {background-color:magenta;}
.blkTyp, .btn {
  cursor: pointer;
}
.blkTyp:hover, .btn:hover {
  background: gray;
}
.blkTyp:active, .btn:active {
  background: black;
  color: white;
}
#current {
  color: coral;
}
#done {
  white-space: pre-wrap;
}
textarea {
  display: block;
  font-family: monospace;
  font-size: inherit;
  width: 200px;
  height: 200px;
}
#width, #height {
  font-weight: bold;
}
    </style>
  </head>
  <body>
    <p><b>Click. Press the arrow keys to expand or shorten the level size.</b><br>
    <span class="blkTyp" id="space">air</span> <span class="blkTyp" id="at">solid</span> <span class="blkTyp" id="hash">lava</span> <span class="blkTyp" id="plus">destination</span> <span class="blkTyp" id="carrot">jumpboost</span> <span class="blkTyp" id="v">stickyground</span> <span class="blkTyp" id="aster">ice</span> <span class="blkTyp" id="equals">mud</span> <span class="blkTyp" id="w">water</span> <span class="blkTyp" id="less">leftconveyorbelt</span> <span class="blkTyp" id="great">rightconveyorbelt</span> <span class="blkTyp" id="c">checkpoint</span>
    <span id="current">solid</span></p>
    <div class="level"></div>
    width: <span id="width"></span> height: <span id="height"></span> <span id="template" class="btn">set height to 6</span><br>
    <span id="done" class="btn">get code for this</span><br>
    <span id="load" class="btn">import</span>
    <textarea placeholder="code here"></textarea>
    <a href="levelplaytest.html">test level</a><br>
    suggest level piece for the <a href='randomlevelgen.html'>randomized level</a> <a href="https://scratch.mit.edu/projects/124314649/">on Scratch</a> <!--or
    <a href="https://docs.google.com/forms/d/e/1FAIpQLSdz6F-IRXt_H6P3nMQCwJKHqSzmi5X0XzgvgI7HtQXeRiUcSw/viewform">on a google form</a>--> (btw these level pieces have to be 4-8 blocks by 6 with no right wall nor ceiling)
    
    <script src="../sheep.js"></script>
    <script>
var level=[ /* space=air, @=ground, #=lava */
  "@@@@@@@@@@@@@@@@@+@@",
  "@              @@w@@",
  "@               www@",
  "@   @===@       www@",
  "@     #         www@",
  "@     #        @w@@@",
  "@v^@@###*>><<**@@@@@",
];
function render() {
  var data="";
  if (typeof level[0]=="object") {
    level.splice(0,1);
  }
  for (var i=0;i<level.length;i++) {
    data+="<div class='levelRow' id='r"+i+"'>";
    for (var j=0;j<level[i].length;j++) {
      switch (level[i][j]) {
        case " ":
          data+="<div class='levelBlock air' id='c"+j+"'></div>";
          break;
        case "@":
          data+="<div class='levelBlock ground' id='c"+j+"'></div>";
          break;
        case "#":
          data+="<div class='levelBlock lava' id='c"+j+"'></div>";
          break;
        case "+":
          data+="<div class='levelBlock win' id='c"+j+"'></div>";
          break;
        case "^":
          data+="<div class='levelBlock jump' id='c"+j+"'></div>";
          break;
        case "=":
          data+="<div class='levelBlock mud' id='c"+j+"'></div>";
          break;
        case "v":
          data+="<div class='levelBlock nojump' id='c"+j+"'></div>";
          break;
        case "*":
          data+="<div class='levelBlock ice' id='c"+j+"'></div>";
          break;
        case "w":
          data+="<div class='levelBlock water' id='c"+j+"'></div>";
          break;
        case "<":
          data+="<div class='levelBlock left' id='c"+j+"'></div>";
          break;
        case ">":
          data+="<div class='levelBlock right' id='c"+j+"'></div>";
          break;
        case "C":
          data+="<div class='levelBlock check' id='c"+j+"'></div>";
          break;
        default:
          data+="<div class='levelBlock glitch' id='c"+j+"'></div>";
      }
    }
    data+="</div>";
  }
  document.querySelector(".level").innerHTML=data;
  document.querySelector("#width").innerHTML=level[0].length;
  document.querySelector("#height").innerHTML=level.length;
}
render();
document.querySelector("p").onclick=function(e){
  if (e.target.className=="blkTyp") {
    document.querySelector("#current").innerHTML={space:"air",at:"solid",hash:"lava",plus:"destination",carrot:"jumpboost",v:"stickyground",aster:"ice",equals:"mud",w:"water",less:"leftconveyorbelt",great:"rightconveyorbelt",c:"checkpoint"}[e.target.id];
  }
}
var mD=false;
document.querySelector(".level").onmousedown=function(e){
  mD=true;
  if (e.target.className.slice(0,10)=="levelBlock") {
    e.target.className="levelBlock "+{air:"air",solid:"ground",lava:"lava",destination:"win",jumpboost:"jump",stickyground:"nojump",ice:"ice",mud:"mud",water:"water",leftconveyorbelt:"left",rightconveyorbelt:"right",checkpoint:"check"}[document.querySelector("#current").innerHTML];
    var row=Number(e.target.parentNode.id.slice(1));
    var col=Number(e.target.id.slice(1));
    level[row]=level[row].slice(0,col)+{air:" ",solid:"@",lava:"#",destination:"+",jumpboost:"^",stickyground:"v",ice:"*",mud:"=",water:"w",leftconveyorbelt:"<",rightconveyorbelt:">",checkpoint:"C"}[document.querySelector("#current").innerHTML]+level[row].slice(col+1);
  }
}
document.querySelector(".level").onmouseup=function(){mD=false;}
document.querySelector(".level").onmouseover=function(e){
  if (e.target.className.slice(0,10)=="levelBlock"&&mD) {
    e.target.className="levelBlock "+{air:"air",solid:"ground",lava:"lava",destination:"win",jumpboost:"jump",stickyground:"nojump",ice:"ice",mud:"mud",water:"water",leftconveyorbelt:"left",rightconveyorbelt:"right",checkpoint:"check"}[document.querySelector("#current").innerHTML];
    var row=Number(e.target.parentNode.id.slice(1));
    var col=Number(e.target.id.slice(1));
    level[row]=level[row].slice(0,col)+{air:" ",solid:"@",lava:"#",destination:"+",jumpboost:"^",stickyground:"v",ice:"*",mud:"=",water:"w",leftconveyorbelt:"<",rightconveyorbelt:">",checkpoint:"C"}[document.querySelector("#current").innerHTML]+level[row].slice(col+1);
  }
}
document.body.onkeydown=function(e){
  switch (e.keyCode) {
    case 37:
      if (level[0].length>1) {
        for (var i=0;i<level.length;i++) {
          level[i]=level[i].slice(0,-1);
        }
      }
      break;
    case 39:
      for (var i=0;i<level.length;i++) {
        level[i]+="@";
      }
      break;
    case 40:
      if (level.length>1) {
        level.splice(0,1);
      }
      break;
    case 38:
      level.splice(0,0,"@".repeat(level[0].length));
      break;
  }
  render();
};
function highlight(element) { // based off http://stackoverflow.com/questions/985272/selecting-text-in-an-element-akin-to-highlighting-with-your-mouse
  if (document.body.createTextRange) {
    var ran=document.body.createTextRange();
    ran.moveToElementText(document.querySelector(element));
    ran.select();
  } else if (window.getSelection) {
    var sel=window.getSelection(), ran=document.createRange();
    sel.removeAllRanges(),ran.selectNodeContents(document.querySelector(element))
    sel.addRange(ran);
  }
}
document.querySelector("#done").onclick=function(){
  document.querySelector("textarea").value="[[],\n\""+level.join("\",\n\"")+"\"\n]";
  document.querySelector("textarea").select();
}
document.querySelector("#load").onclick=function(){
  level=JSON.parse(document.querySelector("textarea").value);
  render();
}
document.querySelector("#template").onclick=function(){
  if (level.length>6) {
    level.splice(0,level.length-6);
  } else if (level.length<6) {
    var j=level.length;
    for (var i=0;i<6-j;i++) {
      level.splice(0,0,"@".repeat(level[0].length));
    }
  }
  render();
}
/*
[
"@@@@@@@@@@@@@@",
"@@@@@@@@#@@+@@",
"@@@@@####++++@",
"@@@#######++@@",
"@#########@@@@",
"@@@@@@@@@@@@@@"
]
*/
    </script>
  </body>
</html>
