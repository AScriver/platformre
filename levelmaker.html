<!DOCTYPE html>
<html>
  <head>
    <title>Level makitor</title>
    <meta charset="UTF-8">
    <style>
body {
  font-family: monospace;
}
.level {
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  position: relative;
}
.levelBlock {
  height: 40px;
  width: 40px;
  transition: transform .2s;
  position: absolute;
}
#curB {
  height: 40px;
  width: 40px;
  display: inline-block;
  transform: scale(0.4);
  position: absolute;
}
.levelBlock:hover {
  transform: scale(0.8);
  box-shadow: inset 0 0 3px rgba(0,0,0,0.5);
}
.topOnly:before {
  content: '';
  border-top: 5px solid rgba(0,0,0,0.2);
  display: block;
}
.ground {background:#212121;}
.lava {background:#FF5722;/*animation: lava 2s linear infinite;*/}
.win {background:#8BC34A;background-image:url(icons/materialicon_flag.svg);background-position:center;background-repeat:no-repeat;}
.jump {background:#9C27B0;background-image:url(icons/materialicon_keyboard_arrow_up.svg);background-position:center;background-repeat:no-repeat;}
.mud {background:#795548;}
.nojump {background:#FFC107;background-image:url(icons/materialicon_block.svg);background-position:center;background-repeat:no-repeat;}
.ice {background:#00BCD4;background-image:url(icons/iceshine.svg);background-position:center;background-repeat:no-repeat;}
.water {background:#2196F3;}
.left {background-color:#009688;background-image:url(icons/materialicon_chevron_left.svg);background-position:center;background-repeat:no-repeat;}
.right {background-color:#004D40;background-image:url(icons/materialicon_chevron_right.svg);background-position:center;background-repeat:no-repeat;}
.text {background-color:#eee;background-image:url(icons/materialicon_title.svg);background-position:center;background-repeat:no-repeat;}
.check {background-color:#4CAF50;background-image:url(icons/materialicon_beenhere.svg);background-position:center;background-repeat:no-repeat;}
.fanL, .fanR, .fanB {background-color:#607D8B;}
.fanL:before {content:'';border-right:5px solid rgba(255,255,255,0.2);display:block;height:40px;}
.fanR:before {content:'';border-left:5px solid rgba(255,255,255,0.2);display:block;height:40px;}
.fanB:before {content:'';border-top:5px solid rgba(255,255,255,0.2);display:block;}
.ajump {background-color:#E91E63;background-image:url(icons/materialicon_arrow_upward.svg);background-position:center;background-repeat:no-repeat;}
.glitch {background-color:magenta;}
.blkTyp, .btn {
  cursor: pointer;
}
.blkTyp:hover, .btn:hover {
  background: gray;
}
.blkTyp:active, .btn:active {
  background: black;
  color: white;
}
#current {
  color: coral;
  padding-left: 40px;
  padding-top: 10px;
}
#done {
  white-space: pre-wrap;
}
textarea {
  display: block;
  font-family: monospace;
  font-size: inherit;
  width: 200px;
  height: 200px;
}
#width, #height {
  font-weight: bold;
}
    </style>
  </head>
  <body>
    <p>
      <b>Click. Press the arrow keys to expand or shorten the level size.</b><br>
      <span class="blkTyp" id="space">air</span>
      <span class="blkTyp" id="at">solid</span>
      <span class="blkTyp" id="hash">lava</span>
      <span class="blkTyp" id="plus">destination</span>
      <span class="blkTyp" id="carrot">jumpboost</span>
      <span class="blkTyp" id="v">stickyground</span>
      <span class="blkTyp" id="aster">ice</span>
      <span class="blkTyp" id="equals">mud</span>
      <span class="blkTyp" id="w">water</span>
      <span class="blkTyp" id="less">leftconveyorbelt</span>
      <span class="blkTyp" id="great">rightconveyorbelt</span>
      <span class="blkTyp" id="c">checkpoint</span>
      <span class="blkTyp" id="r">leftfan</span>
      <span class="blkTyp" id="l">rightfan</span>
      <span class="blkTyp" id="b">upfan</span>
      <span class="blkTyp" id="amp">autojumppad</span>
    </p>
    <div id="curB" class="ground"></div><p id="current">solid</p>
    <div class="level"></div>
    width: <span id="width"></span> height: <span id="height"></span> <span id="template" class="btn">set height to 6</span><br>
    <span id="done" class="btn">get code for this</span><br>
    <span id="doneBit" class="btn">get code for this as a level bit</span><br>
    <span id="load" class="btn">import</span>
    <textarea placeholder="code here"></textarea>
    <a href="levelplaytest.html">test level</a><br>
    suggest level piece for the <a href='randomlevelgen.html'>randomized level</a> <a href="https://scratch.mit.edu/projects/124314649/">on Scratch</a> <!--or
    <a href="https://docs.google.com/forms/d/e/1FAIpQLSdz6F-IRXt_H6P3nMQCwJKHqSzmi5X0XzgvgI7HtQXeRiUcSw/viewform">on a google form</a>--> (btw these level pieces have to be 4-8 blocks by 6 with no right wall nor ceiling)

    <script src="../sheep.js"></script>
    <script>
var level=[ /* space=air, @=ground, #=lava */
  "@@@@@@@@@@@@@@@@@+@@",
  "@              @@w@@",
  "@               www@",
  "@   @===@       www@",
  "@     #         www@",
  "@     #        @w@@@",
  "@v^@@###*>><<**@@@@@",
];
function render() {
  var data="";
  if (typeof level[0]=="object") {
    level.splice(0,1);
  }
  for (var i=0;i<level.length;i++) {
    data+="<div class='levelRow' id='r"+i+"'>";
    for (var j=0;j<level[i].length;j++) {
      switch (level[i][j]) {
        case " ":
          data+="<div class='levelBlock air' style='top:"+(i*40)+"px;left:"+(j*40)+"px;' id='c"+j+"'></div>";
          break;
        case "@":
          data+="<div class='levelBlock ground' style='top:"+(i*40)+"px;left:"+(j*40)+"px;' id='c"+j+"'></div>";
          break;
        case "#":
          data+="<div class='levelBlock lava' style='top:"+(i*40)+"px;left:"+(j*40)+"px;' id='c"+j+"'></div>";
          break;
        case "+":
          data+="<div class='levelBlock win' style='top:"+(i*40)+"px;left:"+(j*40)+"px;' id='c"+j+"'></div>";
          break;
        case "^":
          data+="<div class='levelBlock jump topOnly' style='top:"+(i*40)+"px;left:"+(j*40)+"px;' id='c"+j+"'></div>";
          break;
        case "=":
          data+="<div class='levelBlock mud topOnly' style='top:"+(i*40)+"px;left:"+(j*40)+"px;' id='c"+j+"'></div>";
          break;
        case "v":
          data+="<div class='levelBlock nojump topOnly' style='top:"+(i*40)+"px;left:"+(j*40)+"px;' id='c"+j+"'></div>";
          break;
        case "*":
          data+="<div class='levelBlock ice' style='top:"+(i*40)+"px;left:"+(j*40)+"px;' id='c"+j+"'></div>";
          break;
        case "w":
          data+="<div class='levelBlock water' style='top:"+(i*40)+"px;left:"+(j*40)+"px;' id='c"+j+"'></div>";
          break;
        case "<":
          data+="<div class='levelBlock left topOnly' style='top:"+(i*40)+"px;left:"+(j*40)+"px;' id='c"+j+"'></div>";
          break;
        case ">":
          data+="<div class='levelBlock right topOnly' style='top:"+(i*40)+"px;left:"+(j*40)+"px;' id='c"+j+"'></div>";
          break;
        case "C":
          data+="<div class='levelBlock check topOnly' style='top:"+(i*40)+"px;left:"+(j*40)+"px;' id='c"+j+"'></div>";
          break;
        case "L":
          data+="<div class='levelBlock fanL' style='top:"+(i*40)+"px;left:"+(j*40)+"px;' id='c"+j+"'></div>";
          break;
        case "R":
          data+="<div class='levelBlock fanR' style='top:"+(i*40)+"px;left:"+(j*40)+"px;' id='c"+j+"'></div>";
          break;
        case "B":
          data+="<div class='levelBlock fanB' style='top:"+(i*40)+"px;left:"+(j*40)+"px;' id='c"+j+"'></div>";
          break;
        case "&":
          data+="<div class='levelBlock ajump topOnly' style='top:"+(i*40)+"px;left:"+(j*40)+"px;' id='c"+j+"'></div>";
          break;
        default:
          if (level[i][j]!=" ") {
            data+="<div class='levelBlock glitch' style='top:"+(i*40)+"px;left:"+(j*40)+"px;' id='c"+j+"'></div>";
          }
      }
    }
    data+="</div>";
  }
  document.querySelector(".level").innerHTML=data;
  document.querySelector("#width").innerHTML=level[0].length;
  document.querySelector("#height").innerHTML=level.length;
  document.querySelector(".level").style.height=(level.length*40)+"px";
}
render();
var paletteIdToPaletteLabel={
  space:"air",at:"solid",hash:"lava",plus:"destination",carrot:"jumpboost",v:"stickyground",aster:"ice",equals:"mud",w:"water",less:"leftconveyorbelt",great:"rightconveyorbelt",c:"checkpoint",r:"leftfan",l:"rightfan",b:"upfan",amp:"autojumppad"
},paletteLabelToClassName={
  air:"air",solid:"ground",lava:"lava",destination:"win",jumpboost:"jump topOnly",stickyground:"nojump topOnly",ice:"ice",mud:"mud topOnly",water:"water",leftconveyorbelt:"left topOnly",rightconveyorbelt:"right topOnly",checkpoint:"check topOnly",leftfan:"fanR",rightfan:"fanL",upfan:"fanB",autojumppad:"ajump topOnly"
},paletteLabelToSymbol={
  air:" ",solid:"@",lava:"#",destination:"+",jumpboost:"^",stickyground:"v",ice:"*",mud:"=",water:"w",leftconveyorbelt:"<",rightconveyorbelt:">",checkpoint:"C",leftfan:"R",rightfan:"L",upfan:"B",autojumppad:"&"
};
document.querySelector("p").onclick=function(e){
  if (e.target.className=="blkTyp") {
    document.querySelector("#current").innerHTML=paletteIdToPaletteLabel[e.target.id];
    document.querySelector("#curB").className=paletteLabelToClassName[document.querySelector("#current").innerHTML];
  }
}
var mD=false;
document.querySelector(".level").onmousedown=function(e){
  mD=true;
  if (e.target.className.slice(0,10)=="levelBlock") {
    e.target.className="levelBlock "+paletteLabelToClassName[document.querySelector("#current").innerHTML];
    var row=Number(e.target.parentNode.id.slice(1));
    var col=Number(e.target.id.slice(1));
    level[row]=level[row].slice(0,col)+paletteLabelToSymbol[document.querySelector("#current").innerHTML]+level[row].slice(col+1);
  }
}
document.querySelector(".level").onmouseup=function(){mD=false;}
document.querySelector(".level").onmouseover=function(e){
  if (e.target.className.slice(0,10)=="levelBlock"&&mD) {
    e.target.className="levelBlock "+paletteLabelToClassName[document.querySelector("#current").innerHTML];
    var row=Number(e.target.parentNode.id.slice(1));
    var col=Number(e.target.id.slice(1));
    level[row]=level[row].slice(0,col)+paletteLabelToSymbol[document.querySelector("#current").innerHTML]+level[row].slice(col+1);
  }
}
document.body.onkeydown=function(e){
  switch (e.keyCode) {
    case 37:
      if (level[0].length>1) {
        for (var i=0;i<level.length;i++) {
          level[i]=level[i].slice(0,-1);
        }
      }
      break;
    case 39:
      for (var i=0;i<level.length;i++) {
        level[i]+="@";
      }
      break;
    case 40:
      if (level.length>1) {
        level.splice(0,1);
      }
      break;
    case 38:
      level.splice(0,0,"@".repeat(level[0].length));
      break;
  }
  render();
};
function highlight(element) { // based off http://stackoverflow.com/questions/985272/selecting-text-in-an-element-akin-to-highlighting-with-your-mouse
  if (document.body.createTextRange) {
    var ran=document.body.createTextRange();
    ran.moveToElementText(document.querySelector(element));
    ran.select();
  } else if (window.getSelection) {
    var sel=window.getSelection(), ran=document.createRange();
    sel.removeAllRanges(),ran.selectNodeContents(document.querySelector(element))
    sel.addRange(ran);
  }
}
document.querySelector("#done").onclick=function(){
  document.querySelector("textarea").value="[[],\n\""+level.join("\",\n\"")+"\"\n]";
  document.querySelector("textarea").select();
}
document.querySelector("#doneBit").onclick=function(){
  document.querySelector("textarea").value="[\n  \""+level.join("\",\n  \"")+"\"\n],";
  document.querySelector("textarea").select();
}
document.querySelector("#load").onclick=function(){
  level=JSON.parse(document.querySelector("textarea").value);
  render();
}
document.querySelector("#template").onclick=function(){
  if (level.length>6) {
    level.splice(0,level.length-6);
  } else if (level.length<6) {
    var j=level.length;
    for (var i=0;i<6-j;i++) {
      level.splice(0,0,"@".repeat(level[0].length));
    }
  }
  render();
}
/*
[
"@@@@@@@@@@@@@@",
"@@@@@@@@#@@+@@",
"@@@@@####++++@",
"@@@#######++@@",
"@#########@@@@",
"@@@@@@@@@@@@@@"
]
*/
    </script>
  </body>
</html>
